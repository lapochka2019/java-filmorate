# java-filmorate
---
![БД проекта](https://github.com/lapochka2019/java-filmorate/blob/main/DB_Filmorate.png)
# Описание базы данных:

База данных предназначена для хранения информации о фильмах и пользователях. Она поддерживает следующие функции:
- Учёт фильмов, их жанров и рейтингов, лайков;
- Учет пользователей, их дружеских связей, поставленными лайками.

---

## База данных

### Таблицы

#### 1. **Film**
Хранит информацию о фильмах.

| Поле         | Тип данных       | Описание                     |
|--------------|------------------|------------------------------|
| `film_id`    | `SERIAL`         | Уникальный идентификатор фильма (PK) |
| `name`       | `VARCHAR`   | Название фильма             |
| `description`| `TEXT`           | Описание фильма             |
| `release_date`| `DATE`           | Дата выпуска фильма         |
| `duration`   | `INT`            | Длительность фильма в минутах|
| `rating_id`  | `INT`            | Идентификатор рейтинга (FK) |

---

#### 2. **Rating**
Хранит информацию о возрастных рейтингах.

| Поле         | Тип данных       | Описание                     |
|--------------|------------------|------------------------------|
| `rating_id`  | `SERIAL`         | Уникальный идентификатор рейтинга (PK) |
| `name`       | `VARCHAR`    | Название рейтинга (например, "PG" или "16+") |

---

#### 3. **Genre**
Хранит информацию о жанрах фильмов.

| Поле         | Тип данных       | Описание                     |
|--------------|------------------|------------------------------|
| `genre_id`   | `SERIAL`         | Уникальный идентификатор жанра (PK) |
| `name`       | `VARCHAR`    | Название жанра (например, "Комедия", "Фантастика") |

---

#### 4. **Film_Genre**
Связывает фильмы и жанры (многие-ко-многим).

| Поле         | Тип данных       | Описание                     |
|--------------|------------------|------------------------------|
| `film_id`    | `INT`            | Идентификатор фильма (FK)   |
| `genre_id`   | `INT`            | Идентификатор жанра (FK)    |

---

#### 5. **User**
Хранит информацию о пользователях.

| Поле         | Тип данных       | Описание                     |
|--------------|------------------|------------------------------|
| `user_id`    | `SERIAL`         | Уникальный идентификатор пользователя (PK) |
| `email`      | `VARCHAR`   | Электронная почта пользователя. |
| `login`      | `VARCHAR`    | Логин пользователя          |
| `name`       | `VARCHAR`   | Имя пользователя            |
| `birthday`   | `DATE`           | Дата рождения пользователя  |

---

#### 6. **Film_Like**
Хранит информацию о лайках пользователей к фильмам.

| Поле         | Тип данных       | Описание                     |
|--------------|------------------|------------------------------|
| `user_id`    | `INT`            | Идентификатор пользователя (FK) |
| `film_id`    | `INT`            | Идентификатор фильма (FK)   |

---

#### 7. **FriendshipType**
Хранит типы дружеских связей.

| Поле         | Тип данных       | Описание                     |
|--------------|------------------|------------------------------|
| `friendship_id` | `SERIAL`       | Уникальный идентификатор типа дружбы (PK) |
| `name`       | `VARCHAR`    | Статус дружбы (подтвержден или неподтвержден) |

---

#### 8. **User_Friend**
Хранит дружеские связи между пользователями.

| Поле            | Тип данных       | Описание                     |
|-----------------|------------------|------------------------------|
| `user_id`       | `INT`            | Идентификатор пользователя (FK) |
| `friend_id`     | `INT`            | Идентификатор друга (FK)    |
| `friendship_type` | `INT`          | Идентификатор типа дружбы (FK) |

---

## Примеры запросов

### 1. Получить список лайков для фильма с названием "Матрица"
```sql
SELECT u.user_id, u.name AS user_name
FROM Film_Like fl
JOIN User u ON fl.user_id = u.user_id
JOIN Film f ON fl.film_id = f.film_id
WHERE f.name = 'Матрица';
```

### 2. Получить список всех друзей пользователя с `user_id = 2`
```sql
SELECT u.user_id, u.name AS friend_name
FROM User_Friend uf
JOIN User u ON uf.friend_id = u.user_id
WHERE uf.user_id = 2;
```

### 3. Получить список фильмов с рейтингом 16+
```sql
SELECT f.film_id, f.name AS film_name
FROM Film f
JOIN Rating r ON f.rating_id = r.rating_id
WHERE r.name = '16+';
```

### 4. Получить 10 фильмов с наибольшим количеством лайков
```sql
SELECT f.film_id, f.name AS film_name, COUNT(fl.user_id) AS like_count
FROM Film f
LEFT JOIN Film_Like fl ON f.film_id = fl.film_id
GROUP BY f.film_id, f.name
ORDER BY like_count DESC
LIMIT 10;
```



